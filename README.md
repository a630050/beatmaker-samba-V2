
https://a630050.github.io/beatmaker-samba-V2/

這是一個專為森巴鼓團設計的線上編曲與練習工具。無論您是指導老師、學生或對森巴打擊樂充滿熱情的玩家，這個工具都能幫助您輕鬆創建、視覺化、分享和練習森巴鼓的節奏。

透過直覺的圖形化介面，您可以編排多達16個聲部的鼓譜，調整各種樂器的音色，並以不同的模式進行播放練習。此外，程式還支援完整的儲存、讀取、**匯出MP3**、**打擊準度測試**、**專業節拍器**以及豐富的快捷鍵操作，旨在成為您森巴鼓學習與創作上的最佳夥伴。


---

## ✨ 主要功能

*   **多軌音序器**：支援最多16個獨立音軌，可自由新增、刪除、**拖曳排序**及命名。
*   **專業音色調校**：內建「調音」面板，可針對每種樂器調整音高、聲像、起音、釋放、濾波等參數，並支援系統預設、使用者自行匯入音檔、合成音效三種模式。
*   **打擊精準度測試**：創新的「打擊測試」功能，可針對任一音軌的節奏進行模擬練習，並提供即時的**分數、偏移分析、左右手準確率**等回饋*(本功能受限於執行效能，效果尚不滿意)*。
*   **可自訂節拍器**：內建功能強大的節拍器，支援**多種模式（輪播/單一/指揮）、燈色、聲音與音量**調整。
*   **樂譜轉換功能**：可將選取的節奏片段 (需為4拍的倍數) 或**整個音軌一鍵轉換**為標準打擊樂譜。轉換後的樂譜視窗是**互動式**的，支援**播放時音符高亮**、切換記號顯示模式、並可直接列印。
*   **進階播放模式**：
    *   **合奏模式**：所有啟用的聲部同時播放。
    *   **輪奏模式**：一次一個聲部，依序循環播放。
*   **視覺化標記系統**：獨特的「標記」模式，可直接在節拍格上標記左右手(R/L)及強弱重音(> / •)，並支援**滑鼠右鍵**快速標記休止符。
*   **靈活的節奏設定**：可自由設定BPM、總拍數 (可從頭或尾刪減)、以及每一拍由幾格組成(2/4/8)，適應不同曲風與練習需求。
*   **完整的專案管理**：
    *   **存檔/載入**：可將整個鼓譜(.json)儲存下來，隨時讀取。
    *   **樣式庫**：可將選取的節奏片段(.pa)存成樣式，方便在不同專案中重複使用。
*   **MP3匯出**：可將您的創作匯出為 MP3 音檔，方便分享或離線聆聽。
*   **高效編輯工具**：提供「編輯」模式，可框選、複製、貼上節奏片段，大幅提升編曲效率。
*   **操作歷史紀錄**：完整的上一步(Undo)/下一步(Redo)功能，讓您安心嘗試各種修改。
*   **豐富的快捷鍵**：支援大量快捷鍵，讓您幾乎可以脫離滑鼠進行所有操作。

---

## 🚀 如何開始

1.  **添加音符**：在右側的節拍網格中，直接用滑鼠**左鍵**點擊格子即可添加或移除音符。
2.  **標記休止符**：在任意格子上點擊**滑鼠右鍵**，可將該格標記為休止符。再次右鍵點擊可取消。
3.  **播放/暫停**：點擊上方的 **▶ 播放** 按鈕或按下 `空白鍵` / `P` 鍵來播放音樂。再次點擊或按鍵則會暫停。
4.  **停止播放**：按下 `S` 鍵可隨時停止播放並將播放軸歸零。
5.  **選擇樂器**：在左側的音軌控制面板中，使用下拉選單為每個音軌選擇不同的森巴鼓樂器。
6.  **調整BPM**：在中間的控制列中找到 `BPM` 輸入框，直接修改數字或使用鍵盤 `→` / `←` 鍵微調速度。
7.  **標記手法**：點擊 **標記** 按鈕 (或按 `M` 鍵) 進入標記模式，選擇 `R`、`L` 或其他記號，然後點擊格子即可標上。
8.  **儲存你的創作**：點擊 **存檔** 按鈕 (或按 `Ctrl + S`) 將您的心血結晶完整保存下來！

---

## ⚙️ 功能詳解

### 主控制列 (上方)

*   **? 指引**：打開使用說明文件。
*   **⏱️ 節拍器**：打開節拍器設定面板，可調整其開關、模式、燈色、聲音與音量。
*   **🎵 調音**：打開專業音色調整面板，可對所有樂器進行細膩的聲音設計。
*   **▶ 播放**：播放或暫停音樂。
*   **重置**：清除所有音符與標記，但保留音軌設定。
*   **上一步/下一步**：復原或重做您的操作。
*   **編輯** (`E` 鍵)：進入/退出選取模式。啟用後會出現工具列：
    *   **複製 (`Ctrl+C`)**：複製框選的節奏。
    *   **貼上 (`Ctrl+V`)**：貼上已複製的節奏。
    *   **儲存/載入樣式**：將選取範圍存成 `.pa` 檔案，或讀取已存的樣式檔。
    *   **轉鼓譜 (`D` 鍵)**：將框選的有效範圍 (需為4拍的倍數) 轉換為樂譜。
*   **標記** (`M` 鍵)：進入/退出標記模式。啟用後會出現標記工具列，可選擇左右手、強弱音或橡皮擦。
*   **檔案操作**：
    *   **存檔 (`Ctrl+S`)**：將整個專案存為 `.json` 檔。
    *   **載入**：讀取 `.json` 專案檔。
    *   **匯出MP3**：將當前編曲匯出為 MP3。
*   **循環次數**：設定匯出MP3時，樂句要重複的次數。

### 節奏設定列 (中間)

*   **合奏/輪奏**：切換播放模式。
*   **一拍長度**：設定每一拍由多少個格子組成，數字越大，代表解析度越高。
*   **節拍長度**：使用 `+` (從結尾增加)、最右側 `-` (從結尾減少)、最左側 `-` (從開頭減少) 來調整總拍數，皆以4拍為單位。
*   **BPM / 音量**：設定全域的曲速與音量。
*   **顯示選項**：
    *   **拍數顯示**：在有音符的格子上顯示其屬於第幾拍。
    *   **LR顯示**：顯示/隱藏左右手標記。
    *   **強弱顯示**：顯示/隱藏強弱音記號。
*   **色差提示**：點擊「左右」或「強弱」按鈕，可將對應的音符（如左手音或弱音）以較暗的顏色顯示，幫助練習時快速辨識。

### 音序器面板 (下方)

#### 左側音軌控制

*   **軌道標籤**：雙擊標籤 (如 `S1`) 可自訂名稱 (最多2個字元)。
*   **拖曳音軌**：按住並拖曳整個音軌控制項，可以重新排序音軌。
*   **樂器選擇**：下拉選單選擇該軌道的樂器。
*   **打擊測試 (🥁)**：點擊鼓圖示，針對此音軌的節奏開啟打擊練習模式 (詳見下方的打擊測試視窗說明)，測試你的節奏準確度。
*   **一鍵轉譜 (♫)**：點擊音符按鈕，可立即將該軌道的完整節奏轉換為樂譜 (詳見下方的樂譜視窗說明)。
*   **啟用軌道 (●)**：點擊可讓此軌道靜音(Mute)。
*   **啟用聲音 (🔊)**：點擊可讓此軌道在播放時不出聲，但保留視覺效果。
*   **刪除軌道 (✖)**：當軌道數大於4時，可刪除軌道。
*   **音量條**：獨立調整該軌道的音量。
*   **新增/摺疊按鈕**：`➕` 可新增軌道，`◀` / `▶` 可收合/展開左側面板。

#### 右側節拍網格

*   **格子(Step)**：編曲的核心區域。**左鍵**點擊放置音符，**右鍵**點擊標記為休止符。
*   **播放軸 (Seek Bar)**：頂部的灰色長條。在非播放狀態下，點擊任意位置可將紅色播放軸移動到該處，並高亮對應的欄位。按下 `播放` 將從該位置開始。

### 樂譜視窗 (互動功能)
當您點擊「轉樂譜」按鈕後，會彈出樂譜視窗，提供以下互動功能：

*   **播放樂譜 (`▶ 播放`)**：點擊後會根據目前樂譜的範圍進行播放，且對應的音符會即時**高亮**，幫助您跟上節奏。
*   **列印 (`🖨 列印`)**：產生一份適合列印的樂譜頁面。
*   **拍號提示**：勾選此項，會在譜表上方顯示拍數（1, 2, 3, 4），幫助辨識音符在小節中的位置。
*   **記號顯示 (左右 / 強弱)**：您可以切換譜面要顯示「左右手(R/L)」標記還是「強弱(> / •)」標記，以符合不同的練習需求。

### 打擊測試視窗 (互動功能) 
當您點擊音軌旁的鼓圖示 (🥁) 時，會開啟此練習模組。它會讀取該音軌的節奏，讓您跟打練習：

*   **目標音格**：顯示您需要跟打的正確節奏與左右手(R/L)標記。
*   **記錄音格**：即時顯示您的打擊結果。不同顏色代表不同的準確度 (綠色=精準, 黃色=尚可, 紅色=失誤)。
*   **操作流程**：點擊「開始測試」後，會有四個預備拍。您需要使用下方的「L」和「R」按鈕或對應的鍵盤按鍵來打擊。
*   **結果分析**：測試結束後，系統會提供詳細的回饋，包含：
    *   **總分**：綜合評估您的表現。
    *   **打點分析**：統計「精準」、「過早」、「過晚」、「失誤」的次數。
    *   **左右手準確率**：如果您在主編曲區有標記R/L，這裡會計算您是否使用了正確的手打擊。
*   **高精度模式**：開啟後，會將每一格再細分為兩格，提供更嚴格、更精準的時機點判斷。

---

## ⌨️ 快速鍵清單

#### 一、 播放控制

| 功能 | 按鍵 | 說明 |
| :--- | :--- | :--- |
| **播放 / 暫停** | `Space` 或 `P` | (Play * Pause)開始播放或在目前位置暫停。 |
| **停止並回到開頭** | `S` | (Stop)無論在哪個位置，立即停止播放並將播放軸歸零。 |
| **從頭/選區播放** | `B` | (Back)從第一拍開始播放。若有框選範圍，則從框選處開始播放。 |
| **增加 / 減少 BPM** | `→` / `←` | 微調曲速。 |
| **增加 / 減少 總音量**| `↑` / `↓` | 微調主音量。 |

#### 二、 模式與編輯

| 功能 | 按鍵 | 說明 |
| :--- | :--- | :--- |
| **切換 [編輯] 模式** | `E` | (Edit)進入或退出用於複製/貼上的「編輯」模式。 |
| **全選** | `Ctrl` + `A` | 在 [編輯] 模式下，快速框選所有音軌與節拍。 |
| **複製選取範圍** | `Ctrl` + `C` | 在 [編輯] 模式下，複製已選取的格子。 |
| **貼上樣式** | `Ctrl` + `V` | 在 [編輯] 模式下，貼上已複製的樣式。 |
| **轉換選區為樂譜** | `D` | (d很像音符)在 [編輯] 模式下，若選取範圍有效，可直接轉譜。 |
| **切換 [標記] 模式** | `M` | (Mark)進入或退出用於標記手法的「標記」模式。 |
| **上一步** | `Ctrl` + `Z` | 復原上一個操作。 |
| **下一步** | `Ctrl` + `Y` | 重做上一個復原的操作。 |
| **退出模式 / 取消** | `Esc` | 關閉彈出視窗、[編輯] 或 [標記] 模式，或取消播放軸高亮。 |

#### 三、 標記工具快捷鍵 (需先按 `M` 進入標記模式)

| 功能 | 按鍵 | 說明 |
| :--- | :--- | :--- |
| **選擇 'R' 標記** | `R` | (Right)切換到右手標記工具。 |
| **選擇 'L' 標記** | `L` | (Left)切換到左手標記工具。 |
| **選擇 '>' 強音記號** | `>`  | 切換到強音記號工具。 |
| **選擇 '•' 弱音記號**| `.` | 切換到弱音記號工具。 |
| **選擇橡皮擦** | `X` | 切換到橡皮擦工具。 |

#### 四、 檔案操作

| 功能 | 按鍵 | 說明 |
| :--- | :--- | :--- |
| **儲存鼓譜** | `Ctrl` + `S` | 將目前的鼓譜匯出為 `.json` 檔案。 |

#### 五、 打擊測試快捷鍵 (在測試視窗中)

| 功能 | 按鍵 | 說明 |
| :--- | :--- | :--- |
| **左手打擊** | (鍵盤 `Z`) | 模擬左手打擊。 |
| **右手打擊** | (鍵盤 `/`) | 模擬右手打擊。 |


---

## 📂 檔案格式說明

*   `.json`：完整的專案檔。包含所有音軌、音符、標記、BPM、音色設定等所有資訊。用於儲存和分享整個編曲。
*   `.pa` (Pattern)：樣式檔。只包含選取範圍內的音符與標記資訊。用於儲存常用的節奏片段，方便在不同專案中快速呼叫使用。

---

## 👨‍💻 作者

*   **程式作者**：徐承佑
*   **森巴鼓指導老師**：陳仰真
